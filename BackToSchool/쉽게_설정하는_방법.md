# 🎯 대화 시스템 - 쉽게 설정하는 방법

## ❓ 질문에 대한 답변

### 1. 선택지 설정은 어디서 하나요?

**답변: DialogueTrigger에서만 설정하세요!**

- **DialogueManager의 선택지 UI**: 단순히 화면에 표시만 하는 UI 요소들입니다. (선택지 버튼, 텍스트, 화살표 등)
- **DialogueTrigger의 선택지 설정**: 실제로 대화에 선택지를 추가하는 설정입니다.

**✅ 올바른 사용법:**
1. NPC GameObject 선택
2. DialogueTrigger 컴포넌트 확인
3. Contextual Dialogues → Element 0에서 선택지 설정

**❌ 잘못된 사용법:**
- DialogueManager에서 선택지 설정하려고 함 (설정하는 곳이 아님!)

---

### 2. 글씨 이펙트는 어떻게 넣나요?

**답변: DialogueTrigger에서 설정하세요!**

이제 **DialogueTrigger의 Inspector**에서 바로 설정할 수 있습니다!

---

## 📝 실제 사용 방법 (단계별)

### Step 1: CSV에 기본 대화 작성

**Localization.csv:**
```csv
ID,KOR,ENG
NAME_NPC,친구,Friend
LINE_GREETING,안녕!,Hello!
LINE_SCARY,으악! 무서워!,Ah! Scary!
LINE_QUESTION,뭐 할까?,What should we do?
LINE_CHOICE_1,밥 먹기,Eat
LINE_CHOICE_2,놀기,Play
```

**Conversations.csv:**
```csv
Conversation_ID,Order,Speaker_ID,Line_ID
GREETING_CONVO,1,NAME_NPC,LINE_GREETING
GREETING_CONVO,2,NAME_NPC,LINE_SCARY
GREETING_CONVO,3,NAME_NPC,LINE_QUESTION
```

---

### Step 2: Unity Inspector에서 설정

1. **NPC GameObject 선택**
2. **DialogueTrigger 컴포넌트 확인**

3. **Contextual Dialogues 설정:**
   ```
   Contextual Dialogues
   └── Size: 1
       └── Element 0:
           ├── Day: 1
           ├── Specific State: Lunch_FreeTime
           ├── Behavior: Repeatable
           ├── Conversation ID: "GREETING_CONVO"
           
           ├── [대사 커스터마이징]
           ├── Custom Line Index: 1
           ├── Animation Trigger: "Talk"
           ├── Text Effect: Shake
           ├── Effect Intensity: 0.7
           ├── Sound Effect Name: "scary_sound"
           
           └── [선택지 설정]
               ├── Choice Line Index: 2
               └── Choices
                   └── Size: 2
                       ├── Element 0:
                       │   ├── Choice Text ID: "LINE_CHOICE_1"
                       │   ├── Next Conversation ID: "EAT_CONVO"
                       │   ├── Scene To Load: (비워두기)
                       │   └── State To Change: None
                       └── Element 1:
                           ├── Choice Text ID: "LINE_CHOICE_2"
                           ├── Next Conversation ID: "PLAY_CONVO"
                           ├── Scene To Load: (비워두기)
                           └── State To Change: None
   ```

---

### Step 3: 설정 설명

#### 대사 커스터마이징
- **Custom Line Index**: `1` = 2번째 대사에 적용
  - `0` = 첫 번째 대사
  - `1` = 두 번째 대사
  - `-1` = 적용 안 함
- **Animation Trigger**: `"Talk"` = Animator의 "Talk" 트리거 재생
- **Text Effect**: `Shake` = 흔들림 효과
  - `None`: 효과 없음
  - `Shake`: 흔들림
  - `Wave`: 파도 효과
  - `Bounce`: 튀는 효과
- **Effect Intensity**: `0.7` = 효과 강도 (0.0 ~ 1.0)
- **Sound Effect Name**: `"scary_sound"` = Resources/Sounds/scary_sound.wav 재생

#### 선택지 설정
- **Choice Line Index**: `2` = 3번째 대사 후에 선택지 표시
  - `0` = 첫 번째 대사 후
  - `1` = 두 번째 대사 후
  - `-1` = 마지막 대사 후 (기본값)
- **Choices**: 선택지 목록 (최대 4개)

---

## 🎮 실행 결과

위 설정으로 게임을 실행하면:

1. **첫 번째 대사**: "안녕!" (일반 텍스트)
2. **두 번째 대사**: "으악! 무서워!" 
   - Shake 효과 적용 ✅
   - "Talk" 애니메이션 재생 ✅
   - "scary_sound" 소리 재생 ✅
3. **세 번째 대사**: "뭐 할까?"
4. **선택지 표시**:
   - "밥 먹기" → EAT_CONVO 대화로
   - "놀기" → PLAY_CONVO 대화로

---

## 💡 여러 대사에 각각 다른 이펙트 적용하기

여러 대사에 각각 다른 이펙트를 적용하려면:

**방법 1: Contextual Dialogue를 여러 개 만들기**
```
Contextual Dialogues
├── Element 0: (1번째 대사에 Shake 적용)
│   ├── Conversation ID: "GREETING_CONVO"
│   ├── Custom Line Index: 0
│   └── Text Effect: Shake
│
└── Element 1: (2번째 대사에 Wave 적용)
    ├── Conversation ID: "GREETING_CONVO"
    ├── Custom Line Index: 1
    └── Text Effect: Wave
```

**방법 2: 코드에서 직접 설정** (고급)
```csharp
List<DialogueLine> lines = LocalizationManager.Instance.GetConversation("GREETING_CONVO");
lines[0].textEffect = TextEffectType.Shake; // 1번째 대사
lines[1].textEffect = TextEffectType.Wave;  // 2번째 대사
```

---

## 📋 정리

### ✅ DialogueTrigger에서 설정하는 것들:
- 선택지 설정
- 텍스트 이펙트
- 애니메이션 트리거
- 소리 이펙트
- 대사 위치 지정 (몇 번째 대사에 적용할지)

### ✅ DialogueManager에서 설정하는 것들:
- UI 요소 연결 (말풍선, 선택지 버튼 등)
- 타이핑 속도
- 키 설정

### ✅ CSV에서 작성하는 것들:
- 캐릭터 이름
- 대사 텍스트
- 대화 순서

---

## 🔧 문제 해결

### Q: 이펙트가 안 나와요
- Custom Line Index가 올바른지 확인 (0부터 시작)
- Text Effect가 None이 아닌지 확인
- Effect Intensity가 0보다 큰지 확인

### Q: 선택지가 안 나와요
- Choice Line Index가 올바른지 확인
- Choices 리스트에 선택지가 있는지 확인
- Choice Text ID가 Localization.csv에 있는지 확인

### Q: 애니메이션이 안 나와요
- NPC에 Animator 컴포넌트가 있는지 확인
- Animator Controller에 트리거가 설정되어 있는지 확인
- Animation Trigger 이름이 정확한지 확인

### Q: 소리가 안 나와요
- Resources/Sounds 폴더에 파일이 있는지 확인
- 파일명이 정확한지 확인 (확장자 제외)
- AudioSource가 DialogueManager에 연결되어 있는지 확인

---

이제 Unity Inspector에서 쉽게 설정할 수 있습니다! 🎉




